# Основы NLP

NLP (Natural Language Processing — обработка естественного языка) — это область искусственного интеллекта, которая занимается взаимодействием между компьютерами и людьми с использованием естественного языка (например, русского, английского и т.д.). Цель NLP — научить машины понимать, интерпретировать, генерировать и даже «думать» на человеческом языке.

## Основные задачи NLP

### Токенизация (Tokenization)

Разбиение текста на отдельные элементы — токены (слова, символы, подслова и т.п.).

`Пример: "Я люблю NLP!" → ["Я", "люблю", "NLP", "!"]`

### Лемматизация и стемминг

* **Стемминг (Stemming)**: Отсечение аффиксов у слов, чтобы получить его основу (более грубый и быстрый метод по сравнению с лемматизацией).
`Пример: "походка", "ходить", "ходьба" → "ход"`

* **Лемматизация (Lemmatization)** — приведение слов к начальной форме с учётом грамматики.
`Пример: "бежал", "бегу", "бежали" → "бежать"`

### Определение части речи (Part-of-Speech Tagging)

Присвоение каждому слову грамматической категории (существительное, глагол, прилагательное и т.д.).
`Пример: "Красивый кот спит." → [("Красивый", ADJ), ("кот", NOUN), ("спит", VERB)]`

или

```
Текст:   "Иван работает в Google в Москве"
POS:      PROPN   VERB   ADP PROPN   ADP PROPN
```

Список Part-of-Speech (POS) тегов для `spaCy` для русского языка

| POS-тег | Категория | Пример |
| :------- | :------ | :-------- |
| NOUN | нарицательное существительное | "стол", "книга", "город", "человек" |
| PROPN | имя собственное | "Москва", "Иван", "Россия", "Волга" |
| VERB | глагол | "читать", "писать", "говорить", "думать" |
| AUX | вспомогательный глагол | "быть", "стать", "являться" |
| ADJ | прилагательное | "красивый", "большой", "интересный" |
| PRON | местоимение | "я", "ты", "он", "она", "мы", "они", "этот", "тот" |
| NUM | числительное | "один", "два", "сто", "первый", "второй" |
| ADV | наречие | "быстро", "хорошо", "очень", "там" |
| ADP | предлог | "в", "на", "под", "над", "с", "без" |
| CCONJ | сочинительный союз | "и", "а", "но", "или" |
| SCONJ | подчинительный союз | "что", "чтобы", "если", "потому что" |
| PART | частица | "ли", "бы", "не", "же", "ведь" |
| INTJ | междометие | "ой", "ах", "увы", "здравствуйте" |
| DET | определитель (артикль, указательное слово) | "этот", "тот", "каждый", "весь" |
| SYM | символ | "$", "%", "&" |
| PUNCT | пунктуация | ".", ",", "!", "?", ";", ":" |
| X | другое (неклассифицируемое) |  иностранные слова, нераспознанные токены |

Пример:
```
Красивый       ADJ       adjective
кот            NOUN      noun
сидит          VERB      verb
на             ADP       adposition
большом        ADJ       adjective
столе          NOUN      noun
в              ADP       adposition
Москве         PROPN     proper noun
и              CCONJ     coordinating conjunction
смотрит        VERB      verb
в              ADP       adposition
окно           NOUN      noun
.              PUNCT     punctuation
```

### Распознавание именованных сущностей (Named Entity Recognition, NER)

Поиск и классификация именованных объектов в тексте (имена, организации, локации, даты и т.д.).

Пример: `"Иван Петров работает в Google в Москве."`
```
Именованные сущности:
Текст: 'Иван Петров' | Метка: PER | Описание: Named person or family.
Текст: 'Google' | Метка: ORG | Описание: Companies, agencies, institutions, etc.
Текст: 'Москве' | Метка: LOC | Описание: Non-GPE locations, mountain ranges, bodies of water
```

```
Текст:    "Иван работает в Google в Москве"
NER:       [PERSON]        [ORG]     [GPE]
```

Список NER-категорий

| NER | Категория | Пример |
| :------- | :------ | :-------- |
| PER | имена людей | "Иван Петров", "Мария Иванова", "Александр Сергеевич Пушкин" |
| ORG | компании, учреждения, организации | "Яндекс", "Сбербанк", "МГУ", "ООН" |
| LOC | локации (не-GPE) | "Альпы", "Черное море", "озеро Байкал" |
| GPE | страны, города, штаты | "Россия", "Москва", "Санкт-Петербург", "США" |
| DATE | абсолютные или относительные даты | "15 января 2023 года", "в следующем месяце", "2024 год" |
| TIME |  время суток | "15:30", "два часа дня", "полночь" |
| MONEY | денежные суммы | "100 рублей", "50 долларов", "миллион евро" |
| PERCENT | проценты | "15%", "сто процентов", "двадцать пять процентов" |
| EVENT | названия событий, мероприятий | "Олимпийские игры", "Вторая мировая война", "Каннский кинофестиваль" |
| WORK_OF_ART | названия книг, фильмов, картин | "Война и мир", "Преступление и наказание", "Черный квадрат" |
| LAW | правовые документы, законы | "Конституция РФ", "Гражданский кодекс", "Федеральный закон № 152" |
| LANGUAGE | названия языков | "русский язык", "английский", "китайский" |

Специфические для русского языка категории

| NER | Категория | Пример |
| :------- | :------ | :-------- |
| ADDRESS  | адреса | "ул. Тверская, д. 15", "проспект Мира, 35" |
| FAC | объекты инфраструктуры | "Московский Кремль", "стадион Лужники", "аэропорт Шереметьево" |


### Синтаксический парсинг (Dependency Parsing)

Анализ грамматической структуры предложения для определения связей между словами (что является подлежащим, сказуемым и т.д.).

Пример: 
В предложении `"Кот ловит мышку"` определяется, что `"кот"` — подлежащее, `"ловит"` — сказуемое, а `"мышку"` — прямое дополнение.

Список Dependency labels в `spaCy` для русского языка

| DL | Категория |
| :------- | :------ |
| nsubj  | подлежащее (номинальный субъект) |
| obj | прямое дополнение |
| iobj | косвенное дополнение |
| amod | адъективное определение |
| nummod | числовое определение |
| det | определитель |
| obl | обстоятельство |
| advmod | наречное обстоятельство |
| case | предлог/падежное маркирование |
| conj | сочинительная связь |
| cc | сочинительный союз |
| ROOT | корень предложения |
| punct | пунктуация |

Пример: `Молодой ученый быстро прочитал интересную книгу и сделал важные заметки.`

```
=== Синтаксический разбор ===
Молодой      amod           ученый       Pos: ADJ      adjectival modifier
ученый       nsubj          прочитал     Pos: NOUN     nominal subject
быстро       advmod         прочитал     Pos: ADV      adverbial modifier
прочитал     ROOT           прочитал     Pos: VERB     root
интересную   amod           книгу        Pos: ADJ      adjectival modifier
книгу        obj            прочитал     Pos: NOUN     object
и            cc             сделал       Pos: CCONJ    coordinating conjunction
сделал       conj           прочитал     Pos: VERB     conjunct
важные       amod           заметки      Pos: ADJ      adjectival modifier
заметки      obj            сделал       Pos: NOUN     object
.            punct          прочитал     Pos: PUNCT    punctuation
```

### Итог по Part-of-Speech (POS) Tagging, Named Entity Recognition (NER), Dependency Parsing

**Part-of-Speech (POS) Tagging** - Грамматический анализ и понимание структуры текста

Нужно для:
* Исследование стиля письма - анализ распределения частей речи
* Сравнение текстов - академические vs разговорные тексты
* Изучение языка - для лингвистических исследований
* Поиск по частям речи: "прилагательные описывающие погоду"
* Улучшение релевантности - учет грамматического контекста
* Грамматическая проверка

**Named Entity Recognition (NER)** - Извлечение конкретной фактологической информации

Нужно для: 
* Извлечение информации из документов
* Классификация и категоризация:
    * Новости: автоматическая тегизация по персонам, организациям, местам
    * Юридические документы: поиск упоминаний компаний и законов
    * Медицинские записи: извлечение названий лекарств и диагнозов
* Построение баз знаний
* Улучшение поиска
* Бизнес-аналитика:
    * Анализ отзывов: какие продукты/услуги упоминаются
    * Конкурентный анализ: отслеживание упоминаний компаний
    * Рекрутинг: извлечение навыков из резюме

**Dependency Parsing** - Анализ синтаксических отношений и структуры предложения

Нужно для:
* Понимание смысла предложения
* Извлечение отношений
* Машинный перевод (Сохранение правильной синтаксической структуры. Учет порядка слов для разных языков)
* Вопросно-ответные системы
* Генерация текста (Построение грамматически правильных предложений)

|Задача | Цель | Пример использования |
| :---- | :--- | :--- |
| **POS Tagging** | Грамматический анализ | Поиск "всех прилагательных в отзывах" |
| **NER** | Извлечение фактов | Автоматическое извлечение контактов из писем |
| **Dependency Parsing** | Синтаксический анализ | Понимание "кто кого нанял" в предложении |

Примеры:

Анализ новостей
```py
text = "Гендиректор Apple Тим Кук посетил Лондон 15 января."

# POS: Понимаем грамматическую структуру
# NER: Извлекаем сущности (Apple, Тим Кук, Лондон, 15 января)
# Dependency: Понимаем отношения (Тим Кук → посетил → Лондон)
```

Обработка юридических документов
```py
text = "Компания ООО 'Ромашка' обязуется выплатить 100000 рублей ИП Иванову."

# POS: Определяем части речи для понимания структуры
# NER: Извлекаем организации и суммы
# Dependency: Анализируем обязательства (кто кому что должен)
```

Чат-бот для заказов
```py
query = "Я хочу заказать большую пиццу с доставкой на завтра"

# POS: Определяем тип запроса (желание + объект + время)
# NER: Извлекаем продукт ("пицца") и дату ("завтра")
# Dependency: Понимаем модификаторы ("большую пиццу")
```
